<!DOCTYPE html>
<html lang="en">
    <head>
      <script>
	// Hack for scrolling window when linking to anchor tag with fixed nav header
        var shiftWindow = function() { scrollBy(0, -75) };
        window.addEventListener("hashchange", shiftWindow);
        function load() { if (window.location.hash) shiftWindow(); }
      </script>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>IML Lab1 report - Notes Site</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="../../../css/font-awesome.min.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/http.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="../../../js/base.js"></script> 
    </head>

    <body class="">

      <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
	<div class="container">
	<a class="navbar-brand" href="../../..">Notes Site</a>
	<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
	</button>

	<div class="collapse navbar-collapse">
          <!-- Main navigation -->
          <nav class="nav">
            <ul class="navbar-nav">
              <li >
                <a class="nav-link" href="../../..">Homepage</a>
              </li>
              <li class="nav-item dropdown">
                <a href="#" role="button" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="nav-dropdown-Compiler">Compiler <b class="caret"></b></a>
                <div class="dropdown-menu" aria-labelledby="nav-dropdown-Compiler">
                  
<li class="dropdown-submenu">
  <a href="#" class="dropdown-toggle dropdown-item" data-toggle="dropdown" aria-expanded="false">1 相关基础知识</a>
  <ul class="dropdown-menu">
    
<a href="../../../Compiler/1%20%E7%9B%B8%E5%85%B3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/1%20%E6%AD%A3%E8%A7%84%E5%AE%9A%E4%B9%89/" class="dropdown-item">1 正规定义</a>
    
<a href="../../../Compiler/1%20%E7%9B%B8%E5%85%B3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/2%20%E8%87%AA%E5%8A%A8%E6%9C%BA/" class="dropdown-item">2 自动机</a>
    
<a href="../../../Compiler/1%20%E7%9B%B8%E5%85%B3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/3%20NFA%E8%BD%ACDFA/" class="dropdown-item">3 NFA转DFA</a>
    
<a href="../../../Compiler/1%20%E7%9B%B8%E5%85%B3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/4%20%E6%9E%81%E5%B0%8F%E5%8C%96DFA/" class="dropdown-item">4 极小化DFA</a>
  </ul>
</li>
                  
<li class="dropdown-submenu">
  <a href="#" class="dropdown-toggle dropdown-item" data-toggle="dropdown" aria-expanded="false">2 上下文无关文法</a>
  <ul class="dropdown-menu">
    
<a href="../../../Compiler/2%20%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E6%96%87%E6%B3%95/1%20%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E6%96%87%E6%B3%95%E7%9A%84%E5%AE%9A%E4%B9%89/" class="dropdown-item">1 上下文无关文法的定义</a>
    
<a href="../../../Compiler/2%20%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E6%96%87%E6%B3%95/2%20%E4%BA%8C%E4%B9%89%E6%80%A7/" class="dropdown-item">2 二义性</a>
    
<a href="../../../Compiler/2%20%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E6%96%87%E6%B3%95/3%20%E6%B6%88%E9%99%A4%E5%B7%A6%E9%80%92%E5%BD%92/" class="dropdown-item">3 消除左递归</a>
    
<a href="../../../Compiler/2%20%E4%B8%8A%E4%B8%8B%E6%96%87%E6%97%A0%E5%85%B3%E6%96%87%E6%B3%95/4%20%E6%8F%90%E5%B7%A6%E5%9B%A0%E5%AD%90/" class="dropdown-item">4 提左因子</a>
  </ul>
</li>
                  
<li class="dropdown-submenu">
  <a href="#" class="dropdown-toggle dropdown-item" data-toggle="dropdown" aria-expanded="false">3 自上而下分析</a>
  <ul class="dropdown-menu">
    
<a href="../../../Compiler/3%20%E8%87%AA%E4%B8%8A%E8%80%8C%E4%B8%8B%E5%88%86%E6%9E%90/1%20%E8%87%AA%E4%B8%8A%E8%80%8C%E4%B8%8B%E5%88%86%E6%9E%90/" class="dropdown-item">1 自上而下分析</a>
    
<a href="../../../Compiler/3%20%E8%87%AA%E4%B8%8A%E8%80%8C%E4%B8%8B%E5%88%86%E6%9E%90/2%20FIRST%E5%92%8CFOLLOW%E9%9B%86%E5%90%88/" class="dropdown-item">2 FIRST和FOLLOW集合</a>
    
<a href="../../../Compiler/3%20%E8%87%AA%E4%B8%8A%E8%80%8C%E4%B8%8B%E5%88%86%E6%9E%90/3%20LL%281%29%E6%96%87%E6%B3%95/" class="dropdown-item">3 LL(1)文法</a>
    
<a href="../../../Compiler/3%20%E8%87%AA%E4%B8%8A%E8%80%8C%E4%B8%8B%E5%88%86%E6%9E%90/4%20%E9%A2%84%E6%B5%8B%E5%88%86%E6%9E%90/" class="dropdown-item">4 预测分析</a>
  </ul>
</li>
                  
<li class="dropdown-submenu">
  <a href="#" class="dropdown-toggle dropdown-item" data-toggle="dropdown" aria-expanded="false">4 自下而上分析</a>
  <ul class="dropdown-menu">
    
<a href="../../../Compiler/4%20%E8%87%AA%E4%B8%8B%E8%80%8C%E4%B8%8A%E5%88%86%E6%9E%90/1%20%E6%A6%82%E8%BF%B0/" class="dropdown-item">1 概述</a>
    
<a href="../../../Compiler/4%20%E8%87%AA%E4%B8%8B%E8%80%8C%E4%B8%8A%E5%88%86%E6%9E%90/2%20%E8%A7%84%E7%BA%A6/" class="dropdown-item">2 规约</a>
    
<a href="../../../Compiler/4%20%E8%87%AA%E4%B8%8B%E8%80%8C%E4%B8%8A%E5%88%86%E6%9E%90/3%20%E5%8F%A5%E6%9F%84/" class="dropdown-item">3 句柄</a>
    
<a href="../../../Compiler/4%20%E8%87%AA%E4%B8%8B%E8%80%8C%E4%B8%8A%E5%88%86%E6%9E%90/4%20%E7%A7%BB%E8%BF%9B%E8%A7%84%E7%BA%A6%E5%88%86%E6%9E%90/" class="dropdown-item">4 移进规约分析</a>
  </ul>
</li>
                </div>
              </li>
              <li class="nav-item dropdown active">
                <a href="#" role="button" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="nav-dropdown-IML">IML <b class="caret"></b></a>
                <div class="dropdown-menu" aria-labelledby="nav-dropdown-IML">
                  
<li class="dropdown-submenu">
  <a href="#" class="dropdown-toggle dropdown-item" data-toggle="dropdown" aria-expanded="false">1 数学基础</a>
  <ul class="dropdown-menu">
    
<a href="../../1_%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/1_%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" class="dropdown-item">1 线性代数</a>
    
<a href="../../1_%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/2_%E6%A6%82%E7%8E%87%E8%AE%BA%E4%B8%8E%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1/" class="dropdown-item">2 概率论与数理统计</a>
    
<a href="../../1_%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/3_%E4%BC%98%E5%8C%96/" class="dropdown-item">3 优化</a>
  </ul>
</li>
                  
<li class="dropdown-submenu">
  <a href="#" class="dropdown-toggle dropdown-item" data-toggle="dropdown" aria-expanded="false">2 模型评估</a>
  <ul class="dropdown-menu">
    
<a href="../../2_%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/" class="dropdown-item">模型评估与选择</a>
  </ul>
</li>
                  
<li class="dropdown-submenu">
  <a href="#" class="dropdown-toggle dropdown-item" data-toggle="dropdown" aria-expanded="false">3 线性模型</a>
  <ul class="dropdown-menu">
    
<a href="../1_%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92/" class="dropdown-item">1 线性回归</a>
    
<a href="../2_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92/" class="dropdown-item">2 对数几率回归</a>
    
<a href="../3_%E7%BA%BF%E6%80%A7%E5%88%A4%E5%88%AB%E5%88%86%E6%9E%90/" class="dropdown-item">3 线性判别分析</a>
    
<a href="./" class="dropdown-item active">IML Lab1 report</a>
  </ul>
</li>
                </div>
              </li>
            </ul>
          </nav>

          <ul class="navbar-nav flex-row ml-md-auto d-none d-md-flex">
            <li class="nav-item">
              <a class="nav-link" href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
		<i class="fa fa-search"></i> Search
              </a>
            </li>
          </ul>
	</div>
	</div>
      </nav><div id="content" class="container">
        
      <div class="row">
        <div class="col-md-9" role="main">


<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    
    
    <li class="breadcrumb-item">IML</li>
    
    
    
    <li class="breadcrumb-item">3 线性模型</li>
    
    
    <li class="breadcrumb-item active" aria-current="page">IML Lab1 report</li>
  </ol>
</nav>


<h1 id="iml-lab1-report">IML Lab1 report</h1>
<p><strong>Author</strong>: Ruixuan Huang     <strong>Student ID</strong>: PB20111686</p>
<div class="toc">
<ul>
<li><a href="#iml-lab1-report">IML Lab1 report</a><ul>
<li><a href="#aims">Aims</a></li>
<li><a href="#methods">Methods</a></li>
<li><a href="#result">Result</a><ul>
<li><a href="#loss-curve">Loss curve</a></li>
<li><a href="#comparation-table">Comparation table</a><ul>
<li><a href="#pnr">PNR</a></li>
<li><a href="#tar">TAR</a></li>
<li><a href="#lr">lr</a></li>
</ul>
</li>
<li><a href="#best-accuracy">Best accuracy</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="aims">Aims</h2>
<ol>
<li>Implement logistic regression framework using given dataset</li>
<li>Use the given dataset to test the model we trained</li>
<li>Illustrate loss curve of one training process</li>
<li>Give comparation table of different parameters</li>
<li>Give the best accuracy of test data</li>
</ol>
<h2 id="methods">Methods</h2>
<p><strong>Step1</strong>. Data process</p>
<p>The original dataset (<code>loan.csv</code>) is typical for dichotomous classification problem. Before using it to train models, I noted that there are some cases with missing attributes. Here my choice is using <code>df.dropna()</code> to discard these cases.</p>
<p>Then, we should convert non numerical descriptions of some attributes to continuous numerical descriptions. I noted that the values of each to-be-converted attribute have some order relationship. So I simply use <code>df[{attr_name}].map()</code> to convert.</p>
<p>I decided to use hold-out method to train a model. So my strategy to split the dataset can be described as follows:</p>
<ol>
<li>Use <code>df.sample(frac=1.0)</code> to randomize the dataset</li>
<li>Use <code>df.sort_values("Loan_Status", inplace=True)</code> to place the positive and negative cases in two consecutive areas to facilitate the data spliting</li>
<li>In the positive area, choose its top 40% cases and add them into <code>X_train</code> and <code>y_train</code>. For negative cases the rate is 80%. This is because the proportion of positive and negative of original dataset is 2:1</li>
<li>After executing the above 3 procedures, I get the <code>X_train</code>, <code>X_test</code>, <code>y_train</code>, <code>y_test</code></li>
</ol>
<p><strong>Step2</strong>. Implement the LR class</p>
<p>According to the (3.27) in the textbook, our objective is to minimize</p>
<div class="arithmatex">
<div class="MathJax_Preview">
l(\boldsymbol{\beta})=\sum_{i=1}^m\left(-y_i\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i+\ln\left(1+e^{\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i}\right)\right)
</div>
<script type="math/tex; mode=display">
l(\boldsymbol{\beta})=\sum_{i=1}^m\left(-y_i\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i+\ln\left(1+e^{\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i}\right)\right)
</script>
</div>
<p>I assumed that <code>fit_intercept=True</code>, so here <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{\beta}=(\boldsymbol{w};b),\hat{\boldsymbol{x}}=(\boldsymbol{x};1)</span><script type="math/tex">\boldsymbol{\beta}=(\boldsymbol{w};b),\hat{\boldsymbol{x}}=(\boldsymbol{x};1)</script></span>.</p>
<blockquote>
<p>In my code I also dealt with the situation when <code>fit_intercept=False</code>, but in the report I'll only discuss the situation when <code>fit_intercept=True</code>.</p>
</blockquote>
<p>I use <span class="arithmatex"><span class="MathJax_Preview">\displaystyle\sigma(x)=\frac{1}{1+e^{-z}}</span><script type="math/tex">\displaystyle\sigma(x)=\frac{1}{1+e^{-z}}</script></span> as the sigmoid function, so the result of one prediction is <span class="arithmatex"><span class="MathJax_Preview">\sigma(\boldsymbol{\beta}^\top\hat{\boldsymbol{x}})</span><script type="math/tex">\sigma(\boldsymbol{\beta}^\top\hat{\boldsymbol{x}})</script></span>. </p>
<p>Now let me implement the training (<code>fit</code>) method. The cost function is</p>
<div class="arithmatex">
<div class="MathJax_Preview">
cost(\boldsymbol\beta)=\frac1m\sum_{i=1}^m[y_i-\sigma(\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i)]^2+\gamma ||\boldsymbol{\beta}||_\text{1 or 2}
</div>
<script type="math/tex; mode=display">
cost(\boldsymbol\beta)=\frac1m\sum_{i=1}^m[y_i-\sigma(\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i)]^2+\gamma ||\boldsymbol{\beta}||_\text{1 or 2}
</script>
</div>
<p>I use gradient descent to decrease the cost function and find the optimal <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol\beta</span><script type="math/tex">\boldsymbol\beta</script></span>. According to the (3.30), the gradient function is</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\nabla_\boldsymbol{\beta}l(\boldsymbol\beta)=\frac{\partial l(\boldsymbol\beta)}{\partial \boldsymbol\beta}=\sum_{i=1}^m[y_i-\sigma(\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i)]\hat{\boldsymbol{x}}_i
</div>
<script type="math/tex; mode=display">
\nabla_\boldsymbol{\beta}l(\boldsymbol\beta)=\frac{\partial l(\boldsymbol\beta)}{\partial \boldsymbol\beta}=\sum_{i=1}^m[y_i-\sigma(\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i)]\hat{\boldsymbol{x}}_i
</script>
</div>
<p>In each iteration, if the absolute value of the increment of the cost function is less than the parameter <code>tol</code>, the iteration will break, which means the training is done. Otherwise the <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol\beta</span><script type="math/tex">\boldsymbol\beta</script></span> should update according to</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\boldsymbol\beta←\boldsymbol\beta+\frac\alpha m\nabla_\boldsymbol{\beta}l(\boldsymbol\beta)
</div>
<script type="math/tex; mode=display">
\boldsymbol\beta←\boldsymbol\beta+\frac\alpha m\nabla_\boldsymbol{\beta}l(\boldsymbol\beta)
</script>
</div>
<p>Here <span class="arithmatex"><span class="MathJax_Preview">\alpha</span><script type="math/tex">\alpha</script></span> is the parameter <code>lr</code>. The training has a maximum number of iteration which is set by the parameter <code>max_iter</code>. One more thing, in order to draw a loss curve, the <code>fit</code> method will return an array of values of cost function during the training process.</p>
<p>The last thing is implementation of <code>predict</code> method. It will use the trained <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol\beta</span><script type="math/tex">\boldsymbol\beta</script></span> to caculate a result for each line in X_test. The result will be caculated according to</p>
<div class="arithmatex">
<div class="MathJax_Preview">
p(\hat{\boldsymbol x}_i)=\sigma(\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i)
</div>
<script type="math/tex; mode=display">
p(\hat{\boldsymbol x}_i)=\sigma(\boldsymbol{\beta}^\top\hat{\boldsymbol{x}}_i)
</script>
</div>
<p>And the <code>predict</code> method will return an array of results from all test lines.</p>
<p><strong>Step3</strong>. Train and test in framework</p>
<p>Now I have the split dataset (<code>X_train</code>, <code>X_test</code>, <code>y_train</code>, <code>y_test</code>) and LR class. Simply call the <code>fit</code> method on <code>X_train</code> and <code>y_train</code>. And using matplotlib to illustrate the loss curve according to the return value of <code>fit</code>.</p>
<p>In the test process simply call the <code>predict</code> method on <code>X_test</code> and get its return value. Then compare each element of it and its corresponding label in <code>y_test</code>. In this process I will use a confusion matrix to display the result of the trained model running on the test dataset.</p>
<p><strong>Step4</strong>. Using different parameters</p>
<p>In order to get the comparation table, I repeat the steps above using one different parameter each time, using accuracy <span class="arithmatex"><span class="MathJax_Preview">\left(\displaystyle\frac{TP+FN}{TP+TN+FP+FN}\right)</span><script type="math/tex">\left(\displaystyle\frac{TP+FN}{TP+TN+FP+FN}\right)</script></span> as the metric. For <code>lr</code>, there will be a extra metric: trend of the loss curve.</p>
<h2 id="result">Result</h2>
<h3 id="loss-curve">Loss curve</h3>
<p>The loss curve (one training process) of training process is as follows. Here the y-axis is the value of cost function, the x-axis is the number of iterations.</p>
<p><img src="Lab1_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92.assets/image-20221008101412662.png" alt="image-20221008101412662" style="zoom:50%;" /></p>
<h3 id="comparation-table">Comparation table</h3>
<p>The original parameters I picked is:</p>
<ul>
<li>Positive and negative cases ratio in test dataset <span class="arithmatex"><span class="MathJax_Preview">(PNR)</span><script type="math/tex">(PNR)</script></span>:    1:1</li>
<li>Ratio of training set data to all <span class="arithmatex"><span class="MathJax_Preview">(TAR)</span><script type="math/tex">(TAR)</script></span>:   50%</li>
<li>Learning rate <span class="arithmatex"><span class="MathJax_Preview">(lr)</span><script type="math/tex">(lr)</script></span>:    0.1</li>
</ul>
<blockquote>
<p>Define some varibles as follows:</p>
<table>
<thead>
<tr>
<th align="center">mark</th>
<th align="center">meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><span class="arithmatex"><span class="MathJax_Preview">c_0</span><script type="math/tex">c_0</script></span></td>
<td align="center">the number of negative cases of the dataset</td>
</tr>
<tr>
<td align="center"><span class="arithmatex"><span class="MathJax_Preview">c_1</span><script type="math/tex">c_1</script></span></td>
<td align="center">the number of positive cases of the dataset</td>
</tr>
<tr>
<td align="center"><span class="arithmatex"><span class="MathJax_Preview">t_0</span><script type="math/tex">t_0</script></span></td>
<td align="center">the number of negative cases of X_train</td>
</tr>
<tr>
<td align="center"><span class="arithmatex"><span class="MathJax_Preview">t_1</span><script type="math/tex">t_1</script></span></td>
<td align="center">the number of positive cases of X_train</td>
</tr>
</tbody>
</table>
<p>The four variables above satisfy the following formulas:
$$
TAR=\frac{t_0+t_1}{c_0+c_1}\quad\quad PNR=\frac{t_1}{t_0}
$$
Given certain TAR and PNR, we can get
$$
t_0=\frac{TAR\times(c_0+c_1)}{1+PNR}\quad\quad t_1=PNR\times t_0
$$
The results above make it easier to change the parameter TAR and PNR when watching their effect of training, which enables us to be free of caculating the size of training set. But one thing to be noticed is that 
$$
\textbf{assert } t_1 &lt;= c_1\textbf{ and }t_0 &lt;= c_0
$$</p>
</blockquote>
<p>Then each time I will use one difference parameter on the basis of these values.</p>
<hr />
<h4 id="pnr">PNR</h4>
<p><img src="Lab1_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92.assets/image-20221009004226081.png" alt="image-20221009004226081" style="zoom:50%;" /></p>
<table>
<thead>
<tr>
<th align="center">PNR</th>
<th align="center">1:1</th>
<th align="center">1.3:1</th>
<th align="center">1.6:1</th>
<th align="center">1.9:1</th>
<th align="center">2.2:1</th>
<th align="center">2.5:1</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Accuracy</td>
<td align="center">63.76%</td>
<td align="center">79.75%</td>
<td align="center">80.87%</td>
<td align="center">81.73%</td>
<td align="center">80.37%</td>
<td align="center">79.75%</td>
</tr>
</tbody>
</table>
<p>Other: <span class="arithmatex"><span class="MathJax_Preview">TAR=0.5,lr=0.1,tol=10^{-5}</span><script type="math/tex">TAR=0.5,lr=0.1,tol=10^{-5}</script></span>    Each <span class="arithmatex"><span class="MathJax_Preview">PNR</span><script type="math/tex">PNR</script></span> case repeated 10 times, The result is the average.</p>
<hr />
<h4 id="tar">TAR</h4>
<p><img src="Lab1_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92.assets/image-20221009003342744.png" alt="image-20221009003342744" style="zoom:50%;" /></p>
<table>
<thead>
<tr>
<th align="center">TAR</th>
<th align="center">20%</th>
<th align="center">30%</th>
<th align="center">40%</th>
<th align="center">50%</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Accuracy</td>
<td align="center">64.73%</td>
<td align="center">69.73%</td>
<td align="center">63.27%</td>
<td align="center">62.68%</td>
</tr>
</tbody>
</table>
<p>Other: <span class="arithmatex"><span class="MathJax_Preview">PNR=1:1,lr=0.1,tol=10^{-5}</span><script type="math/tex">PNR=1:1,lr=0.1,tol=10^{-5}</script></span>    Each <span class="arithmatex"><span class="MathJax_Preview">TAR</span><script type="math/tex">TAR</script></span> case repeated 10 times, The result is the average.</p>
<hr />
<h4 id="lr">lr</h4>
<p><img src="Lab1_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92.assets/image-20221009005524730.png" alt="image-20221009005524730" style="zoom:50%;" /></p>
<table>
<thead>
<tr>
<th align="center">lr</th>
<th align="center">0.05</th>
<th align="center">0.1</th>
<th align="center">0.2</th>
<th align="center">0.4</th>
<th align="center">0.8</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Accuracy</td>
<td align="center">62.38%</td>
<td align="center">62.21%</td>
<td align="center">60.08%</td>
<td align="center">65.94%</td>
<td align="center">58.58%</td>
</tr>
</tbody>
</table>
<p>Other: <span class="arithmatex"><span class="MathJax_Preview">PNR=1:1,TAR=0.5,tol=10^{-5}</span><script type="math/tex">PNR=1:1,TAR=0.5,tol=10^{-5}</script></span>    Each <span class="arithmatex"><span class="MathJax_Preview">lr</span><script type="math/tex">lr</script></span> case repeated 10 times, The result is the average.</p>
<p><img src="Lab1_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92.assets/image-20221009005950272.png" alt="image-20221009005950272" style="zoom: 50%;" /></p>
<p>The loss curve for each case of <span class="arithmatex"><span class="MathJax_Preview">lr</span><script type="math/tex">lr</script></span>. We can intuitively conclude that the larger the value of <span class="arithmatex"><span class="MathJax_Preview">lr</span><script type="math/tex">lr</script></span>, the faster the loss function decreases.</p>
<h3 id="best-accuracy">Best accuracy</h3>
<p>From the results above, the best accuracy is 81.73%, which has these parameters:
$$
PNR=1.9:1\quad TAR=0.5\quad lr=0.1\quad tol=10^{-5}
$$
Its confusion matrix is</p>
<p><img src="Lab1_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92.assets/image-20221009010633455.png" alt="image-20221009010633455" style="zoom:50%;" /></p>

<ul class="metadata page-metadata" data-bi-name="page info" lang="en-us" dir="ltr">
  <li class="last-updated-holder displayDate loading">
    <span class="last-updated-text">Last updated:</span>
    <time role="presentation" datetime="2018-10-25T00:00:00.000Z" data-article-date-source="ms.date"></time>
  </li>
<!--
  <li class="readingTime">
    2 minutes to read
  </li>
-->
  <li class="contributors-holder">
    <span class="contributors-text">Contributors</span>
    <ul class="contributors" data-bi-name="contributors"></ul>
  </li>
</ul>
</div>
        <div class="col-md-3"><div class="navbar-light navbar-expand-md hidden-print sticky-top sticky-offset" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    <div id="toc-collapse" class="navbar-collapse collapse card">
        <ul class="nav flex-column bs-sidenav">
            <li class="nav-item main"><a class="nav-link" href="#iml-lab1-report">IML Lab1 report</a></li>
                <li class="nav-item">
                    <a href="#aims" class="nav-link">Aims</a>
                </li>
                <li class="nav-item">
                    <a href="#methods" class="nav-link">Methods</a>
                </li>
                <li class="nav-item">
                    <a href="#result" class="nav-link">Result</a>
                </li>
        </ul>
    </div>
</div></div>
      </div>
      </div>

      <footer class="col-md-12">
	<hr>
	<div class="container">
	</div>
      </footer>
      <script>
	var base_url = "../../..",
            shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
      </script>
      <script src="../../../js/base.js" defer></script>
      <script src="../../../mathjax-config.js" defer></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" defer></script>
      <script src="../../../search/main.js" defer></script>

      <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <p class="h4 modal-title">Keyboard Shortcuts</p>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
