<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    
    
    <link rel="shortcut icon" href="../../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>1 线性回归 - Notes Site</title>
    <link href="../../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../css/highlight.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../../js/jquery-3.2.1.min.js"></script>
    <script src="../../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "\u57fa\u672c\u5f62\u5f0f", url: "#_top", children: [
          ]},
          {title: "\u7ebf\u6027\u56de\u5f52", url: "#_2", children: [
              {title: "\u5355\u5143\u7ebf\u6027\u56de\u5f52", url: "#_3" },
              {title: "\u591a\u5143\u7ebf\u6027\u56de\u5f52", url: "#_5" },
          ]},
        ];

    </script>
    <script src="../../../js/base.js"></script>
      <script src="../../../mathjax-config.js"></script>
      <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../2_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../2_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92/" class="btn btn-xs btn-link">
        2 对数几率回归
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../2_%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../2_%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/" class="btn btn-xs btn-link">
        模型评估与选择
      </a>
    </div>
    
  </div>

    

    <h2 id="_1">基本形式</h2>
<p>线性模型一般形式
$$
f(\boldsymbol{x})=w_1 x_1+w_2 x_2+\cdots+w_d x_d+b
$$
<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{x}=\left(x_1 ; x_2 ; \cdots, x_d\right)</span><script type="math/tex">\boldsymbol{x}=\left(x_1 ; x_2 ; \cdots, x_d\right)</script></span> 是由属性描述的示例，其中 <span class="arithmatex"><span class="MathJax_Preview">x_i</span><script type="math/tex">x_i</script></span> 是 <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{x}</span><script type="math/tex">\boldsymbol{x}</script></span> 在第 <span class="arithmatex"><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span> 个属性上的取值。</p>
<p>向量形式
$$
f(\boldsymbol{x})=\boldsymbol{w}^{\top} \boldsymbol{x}+b
$$
<span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{w}=\left(w_1 ; w_2 ; \cdots, w_d\right)</span><script type="math/tex">\boldsymbol{w}=\left(w_1 ; w_2 ; \cdots, w_d\right)</script></span> 是属性的权重。</p>
<h2 id="_2">线性回归</h2>
<h3 id="_3">单元线性回归</h3>
<p><strong>目标</strong>：学得一个线性模型以尽可能准确地预测实值输出标记</p>
<p><strong>属性处理</strong>：如果有序关系（如<strong>高</strong>、<strong>矮</strong>）则可以连续化为（<span class="arithmatex"><span class="MathJax_Preview">\{1.0,0.0\}</span><script type="math/tex">\{1.0,0.0\}</script></span>）；如果没有则可以化为 <span class="arithmatex"><span class="MathJax_Preview">k</span><script type="math/tex">k</script></span> 维独热向量，如（“西瓜”，“南瓜”）中的“西瓜”可以化为 <span class="arithmatex"><span class="MathJax_Preview">(1,0)</span><script type="math/tex">(1,0)</script></span>。</p>
<h4 id="_4">最小二乘法</h4>
<p>最小化目标：均方误差
$$
\mathbb{E}(w,b)=\sum_{i=1}^m[y_i-(wx_i+b)]^2
$$
分别对 <span class="arithmatex"><span class="MathJax_Preview">w,b</span><script type="math/tex">w,b</script></span> 求导，令倒数梯度等于0，得到闭式解
$$
b=\frac{1}{m}\sum_i(y-wx_i)=\bar y-w\bar x
$$</p>
<div class="arithmatex">
<div class="MathJax_Preview">
w=\frac{\sum_i y_i(x_i-\bar x)}{\sum_ix_i^2-\frac{1}{m}(\sum_{i}x_i)^2}
</div>
<script type="math/tex; mode=display">
w=\frac{\sum_i y_i(x_i-\bar x)}{\sum_ix_i^2-\frac{1}{m}(\sum_{i}x_i)^2}
</script>
</div>
<blockquote>
<p>这里 <span class="arithmatex"><span class="MathJax_Preview">\mathbb{E}(w,b)</span><script type="math/tex">\mathbb{E}(w,b)</script></span> 是关于 <span class="arithmatex"><span class="MathJax_Preview">w,b</span><script type="math/tex">w,b</script></span> 的凸函数，所以导数均为0时得到最优解。</p>
</blockquote>
<h3 id="_5">多元线性回归</h3>
<p>目标：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
f\left(\boldsymbol{x}_{\boldsymbol{i}}\right)=\boldsymbol{w}^{\top} \boldsymbol{x}_i+b \text { 使得 } f\left(\boldsymbol{x}_i\right) \approx y_i
</div>
<script type="math/tex; mode=display">
f\left(\boldsymbol{x}_{\boldsymbol{i}}\right)=\boldsymbol{w}^{\top} \boldsymbol{x}_i+b \text { 使得 } f\left(\boldsymbol{x}_i\right) \approx y_i
</script>
</div>
<p>把 <span class="arithmatex"><span class="MathJax_Preview">\boldsymbol{w}</span><script type="math/tex">\boldsymbol{w}</script></span> 和 <span class="arithmatex"><span class="MathJax_Preview">b</span><script type="math/tex">b</script></span> 合并成 <span class="arithmatex"><span class="MathJax_Preview">\hat{\boldsymbol{w}}=(\boldsymbol{w};b)</span><script type="math/tex">\hat{\boldsymbol{w}}=(\boldsymbol{w};b)</script></span>，则数据集 <span class="arithmatex"><span class="MathJax_Preview">D</span><script type="math/tex">D</script></span> 需要拓展一个维度（恒为1）。</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\begin{gathered}
\boldsymbol{X}=\left(\begin{array}{ccccc}
x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1 d} &amp; 1 \\
x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2 d} &amp; 1 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
x_{m 1} &amp; x_{m 2} &amp; \cdots &amp; x_{m d} &amp; 1
\end{array}\right)=\left(\begin{array}{cc}
\boldsymbol{x}_1^{\top} &amp; 1 \\
\boldsymbol{x}_2^{\top} &amp; 1 \\
\vdots &amp; \vdots \\
\boldsymbol{x}_m^{\top} &amp; 1
\end{array}\right) \\
\boldsymbol{y}=\left(y_1 ; y_2 ; \cdots ; y_m\right)
\end{gathered}
</div>
<script type="math/tex; mode=display">
\begin{gathered}
\boldsymbol{X}=\left(\begin{array}{ccccc}
x_{11} & x_{12} & \cdots & x_{1 d} & 1 \\
x_{21} & x_{22} & \cdots & x_{2 d} & 1 \\
\vdots & \vdots & \ddots & \vdots & \vdots \\
x_{m 1} & x_{m 2} & \cdots & x_{m d} & 1
\end{array}\right)=\left(\begin{array}{cc}
\boldsymbol{x}_1^{\top} & 1 \\
\boldsymbol{x}_2^{\top} & 1 \\
\vdots & \vdots \\
\boldsymbol{x}_m^{\top} & 1
\end{array}\right) \\
\boldsymbol{y}=\left(y_1 ; y_2 ; \cdots ; y_m\right)
\end{gathered}
</script>
</div>
<h4 id="_6">最小二乘法</h4>
<p>最小化目标：</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\mathbb{E}(\hat{\boldsymbol{w}})=||\boldsymbol{y}-\boldsymbol{X}\hat{\boldsymbol{w}}||_2^2=(\boldsymbol{y}-\boldsymbol{X}\hat{\boldsymbol{w}})^\top(\boldsymbol{y}-\boldsymbol{X}\hat{\boldsymbol{w}})
</div>
<script type="math/tex; mode=display">
\mathbb{E}(\hat{\boldsymbol{w}})=||\boldsymbol{y}-\boldsymbol{X}\hat{\boldsymbol{w}}||_2^2=(\boldsymbol{y}-\boldsymbol{X}\hat{\boldsymbol{w}})^\top(\boldsymbol{y}-\boldsymbol{X}\hat{\boldsymbol{w}})
</script>
</div>
<p>求 <span class="arithmatex"><span class="MathJax_Preview">E(\widehat{w})</span><script type="math/tex">E(\widehat{w})</script></span> 关于变量 <span class="arithmatex"><span class="MathJax_Preview">\widehat{w}</span><script type="math/tex">\widehat{w}</script></span> 的导数得到</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\nabla_{\widehat{w}} E(\widehat{\boldsymbol{w}})=2 \boldsymbol{X}^{\top}(\boldsymbol{X} \widehat{\boldsymbol{w}}-\boldsymbol{y})
</div>
<script type="math/tex; mode=display">
\nabla_{\widehat{w}} E(\widehat{\boldsymbol{w}})=2 \boldsymbol{X}^{\top}(\boldsymbol{X} \widehat{\boldsymbol{w}}-\boldsymbol{y})
</script>
</div>
<p>令其为 0 可以得到 <span class="arithmatex"><span class="MathJax_Preview">\hat w</span><script type="math/tex">\hat w</script></span> 最优解的闭式解，但是涉及到矩阵的逆要稍微做点讨论。</p>
<hr />
<p>如果 <span class="arithmatex"><span class="MathJax_Preview">X^TX</span><script type="math/tex">X^TX</script></span> 是满秩矩阵或者正定矩阵，则可以直接求逆。最优解是</p>
<div class="arithmatex">
<div class="MathJax_Preview">
\hat w^*=(X^TX)^{-1}X^Ty
</div>
<script type="math/tex; mode=display">
\hat w^*=(X^TX)^{-1}X^Ty
</script>
</div>
<p>此时学得的线性回归模型是</p>
<div class="arithmatex">
<div class="MathJax_Preview">
f(\hat{x_i})=\hat{x_i}^T\hat{w}^*
</div>
<script type="math/tex; mode=display">
f(\hat{x_i})=\hat{x_i}^T\hat{w}^*
</script>
</div>
<hr />
<p>实际情况中往往不满足上述条件，就会解出很多个 <span class="arithmatex"><span class="MathJax_Preview">\hat w</span><script type="math/tex">\hat w</script></span> 能使均方误差最小化。此时选择哪一个解要看学习算法的归纳偏好，常见的作法是<a href="https://mp.weixin.qq.com/s/vfWmI3qUD6NNNfzCV2AGPA">引入正则化项</a>。</p>
<blockquote>
<p>引入正则化就相当于再从另一个角度考量这些解，又可以优化一些出去。</p>
</blockquote>

  <br>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../2_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../2_%E5%AF%B9%E6%95%B0%E5%87%A0%E7%8E%87%E5%9B%9E%E5%BD%92/" class="btn btn-xs btn-link">
        2 对数几率回归
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../../2_%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../../2_%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/" class="btn btn-xs btn-link">
        模型评估与选择
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="container-fluid wm-page-content">
  <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>